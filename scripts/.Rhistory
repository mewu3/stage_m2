datadir <- "/home/meijun/Documents/server/data/MSSPE-basic/enterovirus/kmer15/evaluation"
files <- list.files(path=datadir, full.names = TRUE)
pattern = grep(pattern = "allOligo",files,value = TRUE,perl=TRUE)
pattern = grep(pattern = "tsv",pattern,value = TRUE)
pattern
specieCoverage = paste(datadir, "allOligos_reverse.set.coverage", sep="/")
totolSeq = 3625
### the most abondunce kmer coverage
file = pattern[1]
filename = tools::file_path_sans_ext(file)
table = read.delim(file=file, sep="\t")
table[,2] <- table[,2]/totolSeq *100
View(table)
datadir <- "/home/meijun/Documents/server/data/MSSPE-basic/enterovirus/kmer15/evaluation"
files <- list.files(path=datadir, full.names = TRUE)
pattern = grep(pattern = "allOligo",files,value = TRUE,perl=TRUE)
pattern = grep(pattern = "tsv",pattern,value = TRUE)
specieCoverage = paste(datadir, "allOligos_reverse.set.coverage", sep="/")
totolSeq = 3625
### the most abondunce kmer coverage
file = pattern[1]
filename = tools::file_path_sans_ext(file)
table = read.delim(file=file, sep="\t")
file
for (file in files) {
filename = tools::file_path_sans_ext(file)
table = read.delim(file=file, sep="\t",header=TRUE)
table[,2] <- table[,2]/totolSeq *100
table2 <- table %>% separate(position, into = c("position1", "position2"))
table3 <- cbind(table$position, table2)
cols.num <- c("position1", "position2")
table3[cols.num] <- sapply(table3[cols.num],as.numeric)
colnames(table3)[1] <- "position"
table3 <- table3 %>%
arrange(position1)
table3$position <- factor(table3$position, levels=table3$position)
plot <- ggplot(table3, aes(x=position, y=kmerCount)) +
geom_col() +
theme(axis.text.x = element_text(angle=90, size=10)) +
ylim(0,100) +
ylab("kmer Coverage")
plotname = paste(filename, ".pdf", sep="")
savePlot(plot, plotname)
}
datadir <- "/home/meijun/Documents/server/data/MSSPE-basic/enterovirus/kmer15/evaluation"
files <- list.files(path=datadir, pattern = "tsv", full.names = TRUE)
files
datadir <- "/home/meijun/Documents/server/data/MSSPE-basic/enterovirus/kmer15/evaluation"
kmerCount <- list.files(path=datadir, pattern = "tsv", full.names = TRUE)
specieCoverage = paste(datadir, "allOligos_reverse.set.coverage", sep="/")
### the most abondunce kmer coverage
file = pattern[1]
file
### the most abondunce kmer coverage
file = pattern[1]
filename = tools::file_path_sans_ext(file)
filename
library(tidyverse)
read_tsv(file=file, col_names = TRUE)
datadir <- "/home/meijun/Documents/server/data/MSSPE-basic/enterovirus/kmer15/evaluation"
kmerCount <- list.files(path=datadir, pattern = "tsv", full.names = TRUE)
### the most abondunce kmer coverage
file = kmerCount[1]
filename = tools::file_path_sans_ext(file)
read_tsv(file=file, col_names = TRUE)
?read_tsv
read_delim(file=file, delim="\t", col_names=TRUE)
